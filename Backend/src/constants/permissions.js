const ROLES = require("./roles");

const PERMISSIONS = Object.freeze({
  MANAGE_USERS: "manage_users",
  VIEW_SCHOOL_DASHBOARD: "view_school_dashboard",
  EDIT_SCHOOL_DASHBOARD: "edit_school_dashboard",
  MANAGE_STUDENTS: "manage_students",
  MANAGE_TEACHERS: "manage_teachers",
  MANAGE_COMPANIES: "manage_companies",
  MANAGE_JOBS: "manage_jobs",
  VIEW_JOBS: "view_jobs",
  APPLY_JOBS: "apply_jobs",
  MANAGE_LIA: "manage_lia",
  VIEW_LIA: "view_lia",
  MANAGE_CONNECTIONS: "manage_connections",
  VIEW_CONNECTIONS: "view_connections",
  MANAGE_MESSAGES: "manage_messages",
  VIEW_MESSAGES: "view_messages",
  MANAGE_POSTS: "manage_posts",
  VIEW_POSTS: "view_posts",
  MANAGE_DOCUMENTS: "manage_documents",
  VIEW_DOCUMENTS: "view_documents",
  MANAGE_NOTIFICATIONS: "manage_notifications",
  VIEW_NOTIFICATIONS: "view_notifications",
});

const ROLE_PERMISSIONS = {
  [ROLES.PLATFORM_ADMIN]: Object.values(PERMISSIONS),
  [ROLES.SCHOOL_ADMIN]: [
    PERMISSIONS.MANAGE_USERS,
    PERMISSIONS.VIEW_SCHOOL_DASHBOARD,
    PERMISSIONS.EDIT_SCHOOL_DASHBOARD,
    PERMISSIONS.MANAGE_STUDENTS,
    PERMISSIONS.MANAGE_TEACHERS,
    PERMISSIONS.MANAGE_COMPANIES,
    PERMISSIONS.MANAGE_JOBS,
    PERMISSIONS.MANAGE_LIA,
    PERMISSIONS.MANAGE_CONNECTIONS,
    PERMISSIONS.MANAGE_MESSAGES,
    PERMISSIONS.MANAGE_POSTS,
    PERMISSIONS.MANAGE_DOCUMENTS,
    PERMISSIONS.MANAGE_NOTIFICATIONS,
  ],
  [ROLES.EDUCATION_MANAGER]: [
    PERMISSIONS.VIEW_SCHOOL_DASHBOARD,
    PERMISSIONS.EDIT_SCHOOL_DASHBOARD,
    PERMISSIONS.MANAGE_STUDENTS,
    PERMISSIONS.MANAGE_JOBS,
    PERMISSIONS.MANAGE_LIA,
    PERMISSIONS.MANAGE_CONNECTIONS,
    PERMISSIONS.MANAGE_MESSAGES,
    PERMISSIONS.MANAGE_DOCUMENTS,
    PERMISSIONS.MANAGE_POSTS,
    PERMISSIONS.MANAGE_NOTIFICATIONS,
  ],
  [ROLES.TEACHER]: [
    PERMISSIONS.VIEW_SCHOOL_DASHBOARD,
    PERMISSIONS.VIEW_JOBS,
    PERMISSIONS.VIEW_LIA,
    PERMISSIONS.VIEW_CONNECTIONS,
    PERMISSIONS.VIEW_MESSAGES,
    PERMISSIONS.VIEW_POSTS,
    PERMISSIONS.VIEW_DOCUMENTS,
  ],
  [ROLES.STUDENT]: [
    PERMISSIONS.VIEW_SCHOOL_DASHBOARD,
    PERMISSIONS.VIEW_JOBS,
    PERMISSIONS.APPLY_JOBS,
    PERMISSIONS.VIEW_LIA,
    PERMISSIONS.MANAGE_CONNECTIONS,
    PERMISSIONS.MANAGE_MESSAGES,
    PERMISSIONS.MANAGE_POSTS,
    PERMISSIONS.MANAGE_DOCUMENTS,
    PERMISSIONS.VIEW_NOTIFICATIONS,
  ],
  [ROLES.UNIVERSITY_ADMIN]: [
    PERMISSIONS.MANAGE_USERS,
    PERMISSIONS.VIEW_SCHOOL_DASHBOARD,
    PERMISSIONS.EDIT_SCHOOL_DASHBOARD,
    PERMISSIONS.MANAGE_JOBS,
    PERMISSIONS.MANAGE_LIA,
    PERMISSIONS.MANAGE_CONNECTIONS,
    PERMISSIONS.MANAGE_MESSAGES,
    PERMISSIONS.MANAGE_POSTS,
    PERMISSIONS.MANAGE_DOCUMENTS,
  ],
  [ROLES.UNIVERSITY_MANAGER]: [
    PERMISSIONS.VIEW_SCHOOL_DASHBOARD,
    PERMISSIONS.MANAGE_JOBS,
    PERMISSIONS.MANAGE_LIA,
    PERMISSIONS.MANAGE_CONNECTIONS,
    PERMISSIONS.MANAGE_MESSAGES,
    PERMISSIONS.MANAGE_POSTS,
    PERMISSIONS.MANAGE_DOCUMENTS,
  ],
  [ROLES.COMPANY_EMPLOYER]: [
    PERMISSIONS.VIEW_SCHOOL_DASHBOARD,
    PERMISSIONS.MANAGE_JOBS,
    PERMISSIONS.MANAGE_LIA,
    PERMISSIONS.MANAGE_MESSAGES,
    PERMISSIONS.MANAGE_POSTS,
    PERMISSIONS.MANAGE_DOCUMENTS,
    PERMISSIONS.MANAGE_CONNECTIONS,
  ],
  [ROLES.COMPANY_HIRING_MANAGER]: [
    PERMISSIONS.VIEW_SCHOOL_DASHBOARD,
    PERMISSIONS.MANAGE_JOBS,
    PERMISSIONS.MANAGE_LIA,
    PERMISSIONS.MANAGE_MESSAGES,
    PERMISSIONS.MANAGE_CONNECTIONS,
    PERMISSIONS.MANAGE_DOCUMENTS,
  ],
  [ROLES.COMPANY_FOUNDER]: [
    PERMISSIONS.VIEW_SCHOOL_DASHBOARD,
    PERMISSIONS.MANAGE_JOBS,
    PERMISSIONS.MANAGE_LIA,
    PERMISSIONS.MANAGE_MESSAGES,
    PERMISSIONS.MANAGE_POSTS,
    PERMISSIONS.MANAGE_CONNECTIONS,
  ],
  [ROLES.COMPANY_CEO]: [
    PERMISSIONS.VIEW_SCHOOL_DASHBOARD,
    PERMISSIONS.MANAGE_JOBS,
    PERMISSIONS.MANAGE_LIA,
    PERMISSIONS.MANAGE_MESSAGES,
    PERMISSIONS.MANAGE_CONNECTIONS,
    PERMISSIONS.MANAGE_DOCUMENTS,
  ],
};

const roleHasPermission = (roles, permission) =>
  roles?.some((role) => ROLE_PERMISSIONS[role]?.includes(permission));

module.exports = {
  PERMISSIONS,
  ROLE_PERMISSIONS,
  roleHasPermission,
};
